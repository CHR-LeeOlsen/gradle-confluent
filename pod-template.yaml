metadata:
  labels:
    build-tool: gradle
spec:
  containers:
  - name: jnlp
    env:
    - name: CONTAINER_ENV_VAR
      value: jnlp
  - name: gradle
    image: gradle
    command:
    - cat
    tty: true
    env:
    - name: CONTAINER_ENV_VAR
      value: gradle
    - name: GRADLE_USER_HOME
      value: .gradle
  - name: zookeeper
    image: confluentinc/cp-zookeeper:5.3.0
    command:
    - cat
    tty: true
    env:
    - name: ZOOKEEPER_CLIENT_PORT
      value: "2181"
    - name: ZOOKEEPER_TICK_TIME
      value: "2000"
  - name: kafka
    image: confluentinc/cp-enterprise-kafka:5.3.0
    command:
    - cat
    tty: true
    env:
    - name: CONFLUENT_METRICS_ENABLE
      value: "true"
    - name: CONFLUENT_METRICS_REPORTER_BOOTSTRAP_SERVERS
      value: localhost:9092
    - name: CONFLUENT_METRICS_REPORTER_TOPIC_REPLICAS
      value: "1"
    - name: CONFLUENT_METRICS_REPORTER_ZOOKEEPER_CONNECT
      value: zookeeper:2181
    - name: CONFLUENT_SUPPORT_CUSTOMER_ID
      value: anonymous
    # - name: KAFKA_ADVERTISED_LISTENERS
    #   value: PLAINTEXT://kafka:29092,PLAINTEXT_HOST://localhost:9092
    - name: KAFKA_AUTO_CREATE_TOPICS_ENABLE
      value: "true"
    - name: KAFKA_BROKER_ID
      value: "1"
    - name: KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS
      value: "100"
    - name: KAFKA_INTER_BROKER_LISTENER_NAME
      value: PLAINTEXT
    - name: KAFKA_LISTENER_SECURITY_PROTOCOL_MAP
      value: PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT
    - name: KAFKA_METRIC_REPORTERS
      value: io.confluent.metrics.reporter.ConfluentMetricsReporter
    - name: KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR
      value: "1"
    - name: KAFKA_ZOOKEEPER_CONNECT
      value: localhost:2181
    ports:
    - containerPort: 9092
  - name: schema-registry
    image: confluentinc/cp-schema-registry:5.3.0
    command:
    - cat
    tty: true
    env:
    - name: SCHEMA_REGISTRY_HOST_NAME
      value: schema-registry
    - name: SCHEMA_REGISTRY_KAFKASTORE_CONNECTION_URL
      value: localhost:2181
  - name: kafka-connect
    image: confluentinc/cp-kafka-connect:5.3.0
    command:
    - cat
    tty: true
    env:
    - name: CONNECT_BOOTSTRAP_SERVERS
      value: localhost:9092
    - name: CONNECT_CONFIG_STORAGE_REPLICATION_FACTOR
      value: "1"
    - name: CONNECT_CONFIG_STORAGE_TOPIC
      value: docker-connect-configs
    - name: CONNECT_GROUP_ID
      value: compose-connect-group
    - name: CONNECT_HOST
      value: kafka-connect
    - name: CONNECT_INTERNAL_KEY_CONVERTER
      value: org.apache.kafka.connect.json.JsonConverter
    - name: CONNECT_INTERNAL_VALUE_CONVERTER
      value: org.apache.kafka.connect.json.JsonConverter
    - name: CONNECT_KEY_CONVERTER
      value: io.confluent.connect.avro.AvroConverter
    - name: CONNECT_KEY_CONVERTER_SCHEMA_REGISTRY_URL
      value: http://localhost:8081
    - name: CONNECT_LOG4J_LOGGERS
      value: org.apache.kafka.connect.runtime.rest=WARN,org.reflections=ERROR
    - name: CONNECT_LOG4J_ROOT_LOGLEVEL
      value: INFO
    - name: CONNECT_OFFSET_STORAGE_REPLICATION_FACTOR
      value: "1"
    - name: CONNECT_OFFSET_STORAGE_TOPIC
      value: docker-connect-offsets
    - name: CONNECT_PLUGIN_PATH
      value: /usr/share/java
    - name: CONNECT_REST_ADVERTISED_HOST_NAME
      value: kafka-connect
    - name: CONNECT_REST_PORT
      value: "8083"
    - name: CONNECT_STATUS_STORAGE_REPLICATION_FACTOR
      value: "1"
    - name: CONNECT_STATUS_STORAGE_TOPIC
      value: docker-connect-status
    - name: CONNECT_VALUE_CONVERTER
      value: io.confluent.connect.avro.AvroConverter
    - name: CONNECT_VALUE_CONVERTER_SCHEMA_REGISTRY_URL
      value: http://localhost:8081
    ports:
    - containerPort: 8083
  - name: ksql-server
    image: confluentinc/cp-ksql-server:5.3.0
    command:
    - cat
    tty: true
    env:
    - name: KSQL_BOOTSTRAP_SERVERS
      value: localhost:9092
    - name: KSQL_CUB_KAFKA_TIMEOUT
      value: "300"
    - name: KSQL_KSQL_SCHEMA_REGISTRY_URL
      value: http://localhost:8081
    - name: KSQL_KSQL_SERVICE_ID
      value: kafka-examples
    - name: KSQL_LISTENERS
      value: http://0.0.0.0:8088
    ports:
    - containerPort: 8088
  - name: ksql-cli
    image: confluentinc/cp-ksql-cli:5.3.0
    command:
    - cat
    tty: true
  - name: kafkacat
    image: confluentinc/cp-kafkacat:5.3.0
    command:
    - cat
    tty: true
  - name: datagen
    image: confluentinc/ksql-examples:5.3.0
    command:
    - cat
    tty: true